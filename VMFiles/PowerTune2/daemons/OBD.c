//
// This file was generated by the Retargetable Decompiler
// Website: https://retdec.com
// Copyright (c) 2019 Retargetable Decompiler <info@retdec.com>
//

#include <arpa/inet.h>
#include <fcntl.h>
#include <inttypes.h>
#include <netinet/in.h>
#include <stdbool.h>
#include <stdint.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <stropts.h>
#include <sys/socket.h>
#include <termios.h>
#include <unistd.h>

// ----------------- Float Types Definitions ------------------

typedef float float32_t;
typedef double float64_t;

// ------------------------ Structures ------------------------

struct _IO_FILE {
    int32_t e0;
};

struct in_addr {
    int32_t e0;
};

struct sockaddr {
    int32_t e0;
    char e1[14];
};

struct termios {
    int32_t e0;
    int32_t e1;
    int32_t e2;
    int32_t e3;
    char e4;
    char e5[1];
};

// ------------------- Function Prototypes --------------------

int32_t die(char * str);
int32_t SerialConnection(int32_t path);

// --------------------- Global Variables ---------------------

char * g1 = "\x1b\x5b\x31\x3b\x33\x36\x6d";
char * g2 = "\x2a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\xc2\xa9\x20\x32\x30\x31\x38\x20\x4d\x61\x72\x6b\x75\x73\x20\x49\x70\x70\x79\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2a";
char * g3 = "\x1b\x5b\x30\x6d";
char * g4 = "\x1b\x5b\x33\x32\x6d\x4c\x69\x63\x65\x6e\x63\x65\x20\x4b\x65\x79\x20\x76\x61\x6c\x69\x64\x61\x74\x65\x64\x20";
char * g5 = "\x1b\x5b\x33\x31\x6d\x4c\x69\x63\x65\x6e\x63\x65\x20\x4b\x65\x79\x20\x49\x6e\x76\x61\x6c\x69\x64";
char * g6 = "\x1b\x5b\x33\x31\x6d\x55\x73\x61\x67\x65\x3a\x20\x25\x73\x20\x3c\x53\x65\x72\x69\x61\x6c\x20\x50\x6f\x72\x74\x3e\x0a";
char * g7 = "\x1b\x5b\x33\x31\x6d\x53\x65\x72\x69\x61\x6c\x20\x50\x6f\x72\x74\x20\x4f\x70\x65\x6e\x20\x46\x61\x69\x6c\x75\x72\x65";
char * g8 = "\x1b\x5b\x33\x32\x6d\x53\x65\x72\x69\x61\x6c\x20\x50\x6f\x72\x74\x20\x4f\x70\x65\x6e\x20\x53\x75\x63\x63\x65\x73\x66\x75\x6c\x6c\x79";
char * g9 = "\x1b\x5b\x33\x33\x6d\x52\x65\x73\x65\x74\x20\x4f\x42\x44\x20\x45\x4c\x4d\x33\x32\x37\x20\x49\x6e\x74\x65\x72\x66\x61\x63\x65";
char * g10 = "\x1b\x5b\x33\x32\x6d\x25\x73\x0a";
char * g11 = "\x1b\x5b\x33\x33\x6d\x52\x65\x71\x75\x65\x73\x74\x20\x65\x63\x68\x6f\x20\x6f\x66\x66";
char * g12 = "\x1b\x5b\x33\x33\x6d\x52\x65\x71\x75\x65\x73\x74\x20\x53\x70\x61\x63\x65\x73\x20\x4f\x46\x46";
char * g13 = "\x1b\x5b\x33\x33\x6d\x52\x65\x71\x75\x65\x73\x74\x20\x44\x65\x76\x69\x63\x65\x20\x4e\x61\x6d\x65";
char * g14 = "\x1b\x5b\x33\x33\x6d\x41\x75\x74\x6f\x64\x65\x74\x65\x63\x74\x20\x50\x72\x6f\x74\x6f\x63\x6f\x6c";
char * g15 = "\x1b\x5b\x33\x33\x6d\x50\x72\x6f\x74\x6f\x63\x6f\x6c\x20\x6e\x61\x6d\x65\x20";
char * g16 = "\x1b\x5b\x33\x33\x6d\x53\x75\x70\x70\x6f\x72\x74\x65\x64\x20\x50\x49\x44\x53\x20\x30\x2d\x32\x30\x20";
char * g17 = "\x1b\x5b\x33\x33\x6d\x50\x61\x72\x73\x69\x6e\x67\x20\x42\x79\x74\x65\x20\x31\x20\x30\x78\x25\x30\x32\x58\x20\x2e\x2e\x2e\x0a";
char * g18 = "\x1b\x5b\x33\x37\x6d\x50\x49\x44\x20\x30\x78\x25\x30\x32\x58\x20\x73\x75\x70\x70\x6f\x72\x74\x65\x64\x20\x62\x79\x20\x79\x6f\x75\x72\x20\x56\x65\x68\x69\x63\x6c\x65";
char * g19 = "\x1b\x5b\x33\x37\x6d\x70\x6f\x73\x69\x74\x69\x6f\x6e\x20\x25\x64";
char * g20 = "\x1b\x5b\x33\x32\x6d\x25\x64\x20\x0a";
char * g21 = "\x1b\x5b\x33\x33\x6d\x50\x61\x72\x73\x69\x6e\x67\x20\x42\x79\x74\x65\x20\x32\x20\x30\x78\x25\x30\x32\x58\x20\x2e\x2e\x2e\x0a";
char * g22 = "\x1b\x5b\x33\x33\x6d\x50\x61\x72\x73\x69\x6e\x67\x20\x42\x79\x74\x65\x20\x33\x20\x30\x78\x25\x30\x32\x58\x20\x2e\x2e\x2e\x0a";
char * g23 = "\x1b\x5b\x33\x33\x6d\x50\x61\x72\x73\x69\x6e\x67\x20\x42\x79\x74\x65\x20\x34\x20\x30\x78\x25\x30\x32\x58\x20\x2e\x2e\x2e\x0a";
char * g24 = "\x1b\x5b\x33\x33\x6d\x53\x75\x70\x70\x6f\x72\x74\x65\x64\x20\x50\x49\x44\x53\x20\x32\x31\x2d\x34\x30\x20";
char * g25 = "\x1b\x5b\x33\x33\x6d\x53\x75\x70\x70\x6f\x72\x74\x65\x64\x20\x50\x49\x44\x53\x20\x34\x31\x2d\x36\x30\x20";
char * g26 = "\x1b\x5b\x33\x33\x6d\x53\x75\x70\x70\x6f\x72\x74\x65\x64\x20\x50\x49\x44\x53\x20\x36\x31\x2d\x38\x30\x20";
char * g27 = "\x1b\x5b\x33\x31\x6d\x55\x44\x50\x20\x73\x65\x6e\x64\x20\x70\x6b\x74\x20\x66\x61\x69\x6c";
int32_t g28 = 16;
struct _IO_FILE * g29 = NULL;
struct _IO_FILE * g30 = NULL;
struct _IO_FILE * g31 = NULL;
int32_t g32 = 0;
char * g33;
struct sockaddr * g34 = NULL;
int32_t g35 = 0;
struct in_addr * g36 = NULL;
int32_t g37 = 0;
int32_t g38 = 0;
int32_t g39 = 0; // lr
int32_t g40;
int32_t g41;
int32_t g42;

// ------------------------ Functions -------------------------

// Address range: 0x10af0 - 0x10b10
int32_t die(char * str) {
    // 0x10af0
    perror(str);
    exit(1);
    return &g42;
}

// Address range: 0x10b10 - 0x15184
int main(int argc, char ** argv) {
    printf((char *)&g1);
    puts("**********************************************************************************");
    puts("*                            PowerTune UDP Daemon for                            *");
    puts("*                                  OBD2 ELM327                                   *");
    puts("*                                  Version 1.4                                   *");
    puts((char *)&g2);
    puts("*                                                                                *");
    puts("*                    THIS SOFTWARE IS PROVIDED BY THE AUTHOR                     *");
    puts("* ``AS IS'' AND ANY EXPRESS OR IMPLIED WARRANTIES,INCLUDING, BUT NOT LIMITED TO, *");
    puts("* THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE *");
    puts("* ARE DISCLAIMED. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY DIRECT,         *");
    puts("* INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES             *");
    puts("* (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;   *");
    puts("* LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND    *");
    puts("* ON ANY THEORY OF LIABILITY,WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT      *");
    puts("* (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS  *");
    puts("* SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.                   *");
    puts("*              Use of this software is strictly for PowerTune.                   *");
    puts("* The distribution and sale of this Software is exclusive to the copyright       *");
    puts("*                        owner and his affilliates.                              *");
    puts("*      To purchase a legal copy ,please email Markus.Ippy1981@gmail.com          *");
    puts("**********************************************************************************");
    printf((char *)&g3);
    char v1 = 0; // bp-597
    char v2 = 0; // bp-598
    char v3 = 0; // bp-599
    char v4 = 0; // bp-600
    int32_t sock_fd = socket(AF_INET, SOCK_DGRAM, IPPROTO_IP); // 0x10c60
    int32_t str; // bp-2152
    strncpy((char *)&str, "eth0", 15);
    ioctl(sock_fd, 0x8927);
    close(sock_fd);
    struct _IO_FILE * file = fopen("Licence.lic", "r+"); // 0x10cd4
    int32_t v5;
    int32_t v6; // 0x10d38
    if (file == NULL) {
        goto lab_0x10d98;
    } else {
        // 0x10d74
        int32_t v7; // bp-2252
        v6 = &v7;
        v5 = 0;
        goto lab_0x10d74_2;
    }
  lab_0x10d98:
    // 0x10d98
    fclose(file);
    unsigned char v8;
    unsigned char v9;
    unsigned char v10;
    unsigned char v11;
    unsigned char v12;
    unsigned char v13;
    unsigned char v14;
    unsigned char v15;
    unsigned char v16;
    unsigned char v17;
    uint32_t v18;
    uint32_t v19;
    if (v17 != v16 || v15 != v14 || (int32_t)v13 != v19 % 256 || v12 != v11 || v10 != v9 || v18 % 256 != (int32_t)v8) {
        // 0x10e18
        puts((char *)&g5);
        exit(1);
        // UNREACHABLE
    }
    // 0x10e00
    puts((char *)&g4);
    if (argc != 2) {
        // 0x10e28
        printf((char *)&g6);
        exit(1);
        // UNREACHABLE
    }
    int32_t v20 = SerialConnection(*(int32_t *)((int32_t)argv + 4)); // 0x10e54
    g37 = v20;
    if (v20 <= 0) {
        // 0x10e74
        puts((char *)&g7);
        exit(1);
        // UNREACHABLE
    }
    // 0x10e84
    puts((char *)&g8);
    int32_t sock_fd2 = socket(AF_INET, SOCK_DGRAM, IPPROTO_UDP); // 0x10e98
    g38 = sock_fd2;
    if (sock_fd2 == -1) {
        // 0x10eb8
        die("socket");
        // UNREACHABLE
    }
    // 0x10ec0
    memset((int32_t *)&g34, 0, 16);
    *(int16_t *)&g34 = 2;
    *(int16_t *)&g35 = htons(-0x4e72);
    if (inet_aton("127.0.0.1", (struct in_addr *)&g36) == 0) {
        // 0x10f0c
        fwrite((int32_t *)"inet_aton() failed\n", 1, 19, g29);
        exit(1);
        // UNREACHABLE
    }
    struct _IO_FILE * file2 = fopen("OBD.cfg", "r+"); // 0x10f34
    *(int32_t *)&g31 = (int32_t)file2;
    int32_t v21;
    int32_t v22; // bp-596
    if (file2 != NULL) {
        int32_t v23 = &v22; // 0x10fa0
        int32_t str2; // bp-2460
        int32_t v24;
        if (fgets((char *)&str2, 100, file2) != NULL) {
            int32_t v25 = 0;
            while (true) {
                char * next_token = strtok((char *)&str2, ","); // 0x10f6c
                int32_t v26;
                if (next_token != NULL) {
                    int32_t v27 = v25;
                    int32_t endptr; // bp-2360
                    int32_t v28 = strtoimax(next_token, (char **)&endptr, 0); // 0x10f90
                    *(char *)(v27 + v23) = (char)v28;
                    int32_t v29 = v27 + 1; // 0x10fb8
                    char * next_token2 = strtok(NULL, ","); // 0x10fc8
                    v26 = v29;
                    while (next_token2 != NULL) {
                        // 0x10f78
                        v27 = v29;
                        v28 = strtoimax(next_token2, (char **)&endptr, 0);
                        *(char *)(v27 + v23) = (char)v28;
                        v29 = v27 + 1;
                        next_token2 = strtok(NULL, ",");
                        v26 = v29;
                    }
                } else {
                    v26 = v25;
                }
                // 0x10fdc
                if (fgets((char *)&str2, 100, g31) == NULL) {
                    v24 = v26;
                    // break -> 0x11008
                    break;
                }
                v25 = v26;
            }
        } else {
            v24 = 0;
        }
        // 0x11008
        fclose(g31);
        v21 = v24;
    } else {
        v21 = 0;
    }
    // 0x11018
    *(int32_t *)&g30 = (int32_t)fopen("OBDPIDS.txt", "w+");
    int32_t str3; // bp-496
    int32_t v30 = &str3; // 0x11034
    int32_t v31; // bp-456
    int32_t v32 = (int32_t)&v31 - 1; // 0x12938
    int32_t v33; // r4
    int32_t v34 = (int32_t)&v33 - 480; // 0x128d8
    int32_t v35 = 1;
    int32_t v36 = 0;
    int32_t v37 = 1;
    int32_t v38;
    int32_t v39;
    int32_t v40;
    int32_t v41;
    int32_t v42;
    int32_t v43;
    int32_t v44;
    int32_t v45;
    int32_t v46;
    int32_t v47;
    int32_t v48;
    int32_t v49;
    int32_t v50;
    int32_t v51;
    char * v52;
    char * v53;
    char * v54;
    char * v55;
    char * v56;
    char * v57;
    char * v58;
    char * v59;
    int32_t v60;
    int32_t v61;
    int32_t v62;
    int32_t v63;
    int32_t v64;
    int32_t v65;
    int32_t v66;
    int32_t v67;
    int32_t v68;
    int32_t v69;
    int32_t v70;
    int32_t v71;
    int32_t v72;
    int32_t v73;
    int32_t v74;
    int32_t v75;
    int32_t v76;
    int32_t v77;
    char * v78; // 0x1115c265
    char * v79; // 0x112b4254
    char * v80; // 0x11400243
    char * v81; // 0x1154c232
    char * v82; // 0x116a4221
    char * v83; // 0x117fc210
    char * v84; // 0x11938187
    char * v85; // 0x11f64164
    char * v86; // 0x12428141
    char * v87; // 0x128f8118
    unsigned char v88; // 0x1115c257
    unsigned char v89; // 0x112b4246
    unsigned char v90; // 0x11400235
    unsigned char v91; // 0x1154c224
    unsigned char v92; // 0x116a4213
    unsigned char v93; // 0x117fc202
    unsigned char v94; // 0x11938179
    unsigned char v95; // 0x11f64156
    unsigned char v96; // 0x12428133
    unsigned char v97; // 0x128f8110
    char * v98; // 0x110bc
    char * v99; // 0x114ac
    char * v100; // 0x11604
    char * v101; // 0x1175c
    char * v102; // 0x118b4
    char * v103; // 0x11ee0
    char * v104; // 0x123a4
    char * v105; // 0x12874
    while (true) {
      lab_0x11034_2:
        // 0x11034
        v62 = v37;
        while (true) {
          lab_0x11034:
            // 0x11034
            memset(&str3, 0, 40);
            g40 = v35 - 1;
            switch (v35) {
                case 1: {
                    // 0x11084
                    puts((char *)&g9);
                    write(g37, (int32_t *)"ATZ\r", 4);
                    char * buf = (char *)&str3;
                    while (true) {
                        int32_t v106 = (int32_t)buf; // 0x1119c
                        int32_t v107 = read(g37, (int32_t *)buf, v32 - v106); // 0x111b0
                        if (v107 <= 0) {
                            v52 = buf;
                            v44 = 1;
                            // break -> 0x111cc
                            break;
                        }
                        int32_t v108 = v107 + v106; // 0x110b8
                        v98 = (char *)v108;
                        if (*(char *)(v108 - 1) == 62) {
                            // 0x110d4
                            if (strstr((char *)&str3, "ELM327") == NULL) {
                                v52 = v98;
                                v44 = 1;
                                goto lab_0x111cc;
                            } else {
                                // 0x11150
                                v88 = *(char *)&str3;
                                if (v88 == 16) {
                                    goto lab_0x11168;
                                } else {
                                    v78 = (char *)&str3;
                                    v64 = 0;
                                    v77 = 0;
                                    goto lab_0x11104;
                                }
                            }
                        }
                        buf = v98;
                    }
                    goto lab_0x111cc;
                }
                case 2: {
                    // 0x111dc
                    puts((char *)&g11);
                    write(g37, (int32_t *)"ATE0\r", 5);
                    char * buf2 = (char *)&str3;
                    while (true) {
                        int32_t v109 = (int32_t)buf2; // 0x112f4
                        int32_t v110 = read(g37, (int32_t *)buf2, v32 - v109); // 0x11308
                        if (v110 <= 0) {
                            v63 = v37;
                            v61 = v36;
                            v51 = 2;
                            // break -> 0x12d10
                            break;
                        }
                        int32_t v111 = v110 + v109; // 0x11210
                        if (*(char *)(v111 - 1) == 62) {
                            // 0x1122c
                            if (strstr((char *)&str3, "OK") == NULL) {
                                v63 = v37;
                                v61 = v36;
                                v51 = 2;
                                goto lab_0x12d10;
                            } else {
                                // 0x112a8
                                v89 = *(char *)&str3;
                                if (v89 == 16) {
                                    goto lab_0x112c0;
                                } else {
                                    v79 = (char *)&str3;
                                    v65 = 0;
                                    v76 = 0;
                                    goto lab_0x1125c;
                                }
                            }
                        }
                        buf2 = (char *)v111;
                    }
                    goto lab_0x12d10;
                }
                case 3: {
                    // 0x11328
                    puts((char *)&g12);
                    write(g37, (int32_t *)"ATS0\r", 5);
                    char * buf3 = (char *)&str3;
                    while (true) {
                        int32_t v112 = (int32_t)buf3; // 0x11440
                        int32_t v113 = read(g37, (int32_t *)buf3, v32 - v112); // 0x11454
                        if (v113 <= 0) {
                            v63 = v37;
                            v61 = v36;
                            v51 = 3;
                            // break -> 0x12d10
                            break;
                        }
                        int32_t v114 = v113 + v112; // 0x1135c
                        if (*(char *)(v114 - 1) == 62) {
                            // 0x11378
                            if (strstr((char *)&str3, "OK") == NULL) {
                                v63 = v37;
                                v61 = v36;
                                v51 = 3;
                                goto lab_0x12d10;
                            } else {
                                // 0x113f4
                                v90 = *(char *)&str3;
                                if (v90 == 16) {
                                    goto lab_0x1140c;
                                } else {
                                    v80 = (char *)&str3;
                                    v66 = 0;
                                    v75 = 0;
                                    goto lab_0x113a8;
                                }
                            }
                        }
                        buf3 = (char *)v114;
                    }
                    goto lab_0x12d10;
                }
                case 4: {
                    // 0x11474
                    puts((char *)&g13);
                    write(g37, (int32_t *)"ATI\r", 4);
                    char * buf4 = (char *)&str3;
                    while (true) {
                        int32_t v115 = (int32_t)buf4; // 0x1158c
                        int32_t v116 = read(g37, (int32_t *)buf4, v32 - v115); // 0x115a0
                        if (v116 <= 0) {
                            v57 = buf4;
                            v45 = 4;
                            // break -> 0x115bc
                            break;
                        }
                        int32_t v117 = v116 + v115; // 0x114a8
                        v99 = (char *)v117;
                        if (*(char *)(v117 - 1) == 62) {
                            // 0x114c4
                            if (strstr((char *)&str3, "ELM327") == NULL) {
                                v57 = v99;
                                v45 = 4;
                                goto lab_0x115bc;
                            } else {
                                // 0x11540
                                v91 = *(char *)&str3;
                                if (v91 == 16) {
                                    goto lab_0x11558;
                                } else {
                                    v81 = (char *)&str3;
                                    v67 = 0;
                                    v74 = 0;
                                    goto lab_0x114f4;
                                }
                            }
                        }
                        buf4 = v99;
                    }
                    goto lab_0x115bc;
                }
                case 5: {
                    // 0x115cc
                    puts((char *)&g14);
                    write(g37, (int32_t *)"ATSP00\r", 7);
                    char * buf5 = (char *)&str3;
                    while (true) {
                        int32_t v118 = (int32_t)buf5; // 0x116e4
                        int32_t v119 = read(g37, (int32_t *)buf5, v32 - v118); // 0x116f8
                        if (v119 <= 0) {
                            v58 = buf5;
                            v46 = 5;
                            // break -> 0x11714
                            break;
                        }
                        int32_t v120 = v119 + v118; // 0x11600
                        v100 = (char *)v120;
                        if (*(char *)(v120 - 1) == 62) {
                            // 0x1161c
                            if (strstr((char *)&str3, "OK") == NULL) {
                                v58 = v100;
                                v46 = 5;
                                goto lab_0x11714;
                            } else {
                                // 0x11698
                                v92 = *(char *)&str3;
                                if (v92 == 16) {
                                    goto lab_0x116b0;
                                } else {
                                    v82 = (char *)&str3;
                                    v38 = 0;
                                    v73 = 0;
                                    goto lab_0x1164c;
                                }
                            }
                        }
                        buf5 = v100;
                    }
                    goto lab_0x11714;
                }
                case 6: {
                    // 0x11724
                    puts((char *)&g15);
                    write(g37, (int32_t *)"ATDP\r", 5);
                    char * buf6 = (char *)&str3;
                    while (true) {
                        int32_t v121 = (int32_t)buf6; // 0x1183c
                        int32_t v122 = read(g37, (int32_t *)buf6, v32 - v121); // 0x11850
                        if (v122 <= 0) {
                            v59 = buf6;
                            v47 = 6;
                            // break -> 0x1186c
                            break;
                        }
                        int32_t v123 = v122 + v121; // 0x11758
                        v101 = (char *)v123;
                        if (*(char *)(v123 - 1) == 62) {
                            // 0x11774
                            if (strstr((char *)&str3, "AUTO") == NULL) {
                                v59 = v101;
                                v47 = 6;
                                goto lab_0x1186c;
                            } else {
                                // 0x117f0
                                v93 = *(char *)&str3;
                                if (v93 == 16) {
                                    goto lab_0x11808;
                                } else {
                                    v83 = (char *)&str3;
                                    v39 = 0;
                                    v72 = 0;
                                    goto lab_0x117a4;
                                }
                            }
                        }
                        buf6 = v101;
                    }
                    goto lab_0x1186c;
                }
                case 7: {
                    // 0x1187c
                    puts((char *)&g16);
                    write(g37, (int32_t *)"0100\r", 5);
                    char * buf7 = (char *)&str3;
                    while (true) {
                        int32_t v124 = (int32_t)buf7; // 0x11968
                        int32_t v125 = read(g37, (int32_t *)buf7, v32 - v124); // 0x1197c
                        if (v125 <= 0) {
                            v53 = buf7;
                            v48 = 7;
                            // break -> 0x11990
                            break;
                        }
                        int32_t v126 = v125 + v124; // 0x118b0
                        v102 = (char *)v126;
                        if (*(char *)(v126 - 1) == 62) {
                            // 0x1192c
                            v94 = *(char *)&str3;
                            if (v94 == 16) {
                                v53 = v102;
                                v48 = 8;
                                goto lab_0x11990;
                            } else {
                                v84 = (char *)&str3;
                                v40 = 0;
                                v71 = 0;
                                goto lab_0x118e0;
                            }
                        }
                        buf7 = v102;
                    }
                    goto lab_0x11990;
                }
                case 8: {
                    // 0x11ea8
                    puts((char *)&g24);
                    write(g37, (int32_t *)"0120\r", 5);
                    char * buf8 = (char *)&str3;
                    while (true) {
                        int32_t v127 = (int32_t)buf8; // 0x11fa4
                        int32_t v128 = read(g37, (int32_t *)buf8, v32 - v127); // 0x11fb8
                        if (v128 <= 0) {
                            v54 = buf8;
                            v49 = 8;
                            // break -> 0x11fcc
                            break;
                        }
                        int32_t v129 = v128 + v127; // 0x11edc
                        v103 = (char *)v129;
                        if (*(char *)(v129 - 1) == 62) {
                            // 0x11f58
                            v95 = *(char *)&str3;
                            if (v95 == 16) {
                                goto lab_0x11f70;
                            } else {
                                v85 = (char *)&str3;
                                v41 = 0;
                                v70 = 0;
                                goto lab_0x11f0c;
                            }
                        }
                        buf8 = v103;
                    }
                    goto lab_0x11fcc;
                }
                case 9: {
                    // 0x1236c
                    puts((char *)&g25);
                    write(g37, (int32_t *)"0140\r", 5);
                    char * buf9 = (char *)&str3;
                    while (true) {
                        int32_t v130 = (int32_t)buf9; // 0x12468
                        int32_t v131 = read(g37, (int32_t *)buf9, v32 - v130); // 0x1247c
                        if (v131 <= 0) {
                            v55 = buf9;
                            v50 = 9;
                            // break -> 0x12490
                            break;
                        }
                        int32_t v132 = v131 + v130; // 0x123a0
                        v104 = (char *)v132;
                        if (*(char *)(v132 - 1) == 62) {
                            // 0x1241c
                            v96 = *(char *)&str3;
                            if (v96 == 16) {
                                goto lab_0x12434;
                            } else {
                                v86 = (char *)&str3;
                                v42 = 0;
                                v69 = 0;
                                goto lab_0x123d0;
                            }
                        }
                        buf9 = v104;
                    }
                    goto lab_0x12490;
                }
                case 10: {
                    // 0x1283c
                    puts((char *)&g26);
                    write(g37, (int32_t *)"0160\r", 5);
                    char * buf10 = (char *)&str3;
                    while (true) {
                        int32_t v133 = (int32_t)buf10; // 0x12934
                        int32_t v134 = read(g37, (int32_t *)buf10, v32 - v133); // 0x12948
                        if (v134 <= 0) {
                            v56 = buf10;
                            v60 = 0;
                            // break -> 0x1295c
                            break;
                        }
                        int32_t v135 = v134 + v133; // 0x12870
                        v105 = (char *)v135;
                        if (*(char *)(v135 - 1) == 62) {
                            // 0x128ec
                            v97 = *(char *)&str3;
                            if (v97 == 16) {
                                goto lab_0x12904;
                            } else {
                                v87 = (char *)&str3;
                                v43 = 0;
                                v68 = 0;
                                goto lab_0x128a0;
                            }
                        }
                        buf10 = v105;
                    }
                    goto lab_0x1295c;
                }
                default: {
                    v63 = v37;
                    v61 = v36;
                    v51 = v35;
                    goto lab_0x12d10;
                }
            }
        }
        goto lab_0x12d10;
    }
  lab_0x15168:
    // 0x15168
    if (v60 != 1) {
        // 0x15174
        return 0;
    }
    int32_t v136 = 0;
    int32_t str8; // bp-486
    int32_t str9; // bp-488
    int32_t str7; // bp-490
    int32_t str4; // bp-492
    while (true) {
        int32_t v137 = v21 - 1 > v136 ? v136 + 1 : 0;
        int32_t v138;
        if (v138 == 1) {
            // 0x12d58
            if (g32 == 0) {
                // 0x12d68
                *(char *)&g33 = 12;
                g32 = 1;
            } else {
                // 0x12d84
                *(char *)&g33 = 13;
                g32 = 0;
            }
        }
        // 0x12d9c
        char v139; // 0x12db4
        if (v138 == 0) {
            // 0x12da8
            v139 = *(char *)(v137 + (int32_t)&v22);
            *(char *)&g33 = v139;
        } else {
            // 0x12d9c
            v139 = *(char *)&g33;
        }
        // 0x12dc0
        g41 = (int32_t)v139 - 4;
        int32_t str5; // bp-2120
        switch (v139) {
            case 4: {
                // 0x12f64
                write(g37, (int32_t *)"01041\r", 6);
                char * buf11 = (char *)&str3;
                char * v140; // 0x12f94
                while (true) {
                    int32_t v141 = (int32_t)buf11; // 0x12fc0
                    int32_t v142 = read(g37, (int32_t *)buf11, v32 - v141); // 0x12fd4
                    if (v142 <= 0) {
                        // break -> 0x12ff0
                        break;
                    }
                    int32_t v143 = v142 + v141; // 0x12f90
                    v140 = (char *)v143;
                    if (*(char *)(v143 - 1) == 62) {
                        // break -> 0x12ff0
                        break;
                    }
                    buf11 = v140;
                }
                // 0x12ff0
                *v140 = 0;
                sscanf((char *)&str4, "%02hhX", &v1);
                float64_t v144 = __asm_vcvt_f64_s32(__asm_vmov((int32_t)v1)); // 0x13020
                float64_t v145 = __asm_vldr(0x66666666); // 0x13024
                int32_t v146 = __asm_vmov_2(__asm_vdiv_f64(v144, v145)); // 0x13038
                sprintf((char *)&str5, "46,%f", (float64_t)(int64_t)v146);
                // break -> 0x15158
                break;
            }
            case 5: {
                // 0x13048
                write(g37, (int32_t *)"01051\r", 6);
                char * buf12 = (char *)&str3;
                char * v147;
                while (true) {
                    int32_t v148 = (int32_t)buf12; // 0x130a4
                    int32_t v149 = read(g37, (int32_t *)buf12, v32 - v148); // 0x130b8
                    if (v149 <= 0) {
                        v147 = buf12;
                        // break -> 0x130d4
                        break;
                    }
                    int32_t v150 = v149 + v148; // 0x13074
                    char * v151 = (char *)v150; // 0x13078
                    if (*(char *)(v150 - 1) == 62) {
                        v147 = v151;
                        // break -> 0x130d4
                        break;
                    }
                    buf12 = v151;
                }
                // 0x130d4
                *v147 = 0;
                sscanf((char *)&str4, "%02hhX", &v1);
                sprintf((char *)&str5, "221,%d", (int32_t)v1 - 40);
                // break -> 0x15158
                break;
            }
            case 6: {
                // 0x13120
                write(g37, (int32_t *)"01061\r", 6);
                char * buf13 = (char *)&str3;
                char * v152;
                while (true) {
                    int32_t v153 = (int32_t)buf13; // 0x1317c
                    int32_t v154 = read(g37, (int32_t *)buf13, v32 - v153); // 0x13190
                    if (v154 <= 0) {
                        v152 = buf13;
                        // break -> 0x131ac
                        break;
                    }
                    int32_t v155 = v154 + v153; // 0x1314c
                    char * v156 = (char *)v155; // 0x13150
                    if (*(char *)(v155 - 1) == 62) {
                        v152 = v156;
                        // break -> 0x131ac
                        break;
                    }
                    buf13 = v156;
                }
                // 0x131ac
                *v152 = 0;
                sscanf((char *)&str4, "%02hhX", &v1);
                float64_t v157 = __asm_vcvt_f64_s32(__asm_vmov((int32_t)v1)); // 0x131dc
                float64_t v158 = __asm_vdiv_f64(v157, __asm_vldr(0x47ae147b)); // 0x131e4
                float64_t v159 = __asm_vldr(0); // 0x131e8
                int32_t v160 = __asm_vmov_2(__asm_vsub_f64(v158, v159)); // 0x131fc
                sprintf((char *)&str5, "104,%f", (float64_t)(int64_t)v160);
                // break -> 0x15158
                break;
            }
            case 7: {
                // 0x1320c
                write(g37, (int32_t *)"01071\r", 6);
                char * buf14 = (char *)&str3;
                char * v161;
                while (true) {
                    int32_t v162 = (int32_t)buf14; // 0x13268
                    int32_t v163 = read(g37, (int32_t *)buf14, v32 - v162); // 0x1327c
                    if (v163 <= 0) {
                        v161 = buf14;
                        // break -> 0x13298
                        break;
                    }
                    int32_t v164 = v163 + v162; // 0x13238
                    char * v165 = (char *)v164; // 0x1323c
                    if (*(char *)(v164 - 1) == 62) {
                        v161 = v165;
                        // break -> 0x13298
                        break;
                    }
                    buf14 = v165;
                }
                // 0x13298
                *v161 = 0;
                sscanf((char *)&str4, "%02hhX", &v1);
                float64_t v166 = __asm_vcvt_f64_s32(__asm_vmov((int32_t)v1)); // 0x132c8
                float64_t v167 = __asm_vdiv_f64(v166, __asm_vldr(0x47ae147b)); // 0x132d0
                float64_t v168 = __asm_vldr(0); // 0x132d4
                int32_t v169 = __asm_vmov_2(__asm_vsub_f64(v167, v168)); // 0x132e8
                sprintf((char *)&str5, "102,%f", (float64_t)(int64_t)v169);
                // break -> 0x15158
                break;
            }
            case 8: {
                // 0x132f8
                write(g37, (int32_t *)"01081\r", 6);
                char * buf15 = (char *)&str3;
                char * v170;
                while (true) {
                    int32_t v171 = (int32_t)buf15; // 0x13354
                    int32_t v172 = read(g37, (int32_t *)buf15, v32 - v171); // 0x13368
                    if (v172 <= 0) {
                        v170 = buf15;
                        // break -> 0x13384
                        break;
                    }
                    int32_t v173 = v172 + v171; // 0x13324
                    char * v174 = (char *)v173; // 0x13328
                    if (*(char *)(v173 - 1) == 62) {
                        v170 = v174;
                        // break -> 0x13384
                        break;
                    }
                    buf15 = v174;
                }
                // 0x13384
                *v170 = 0;
                sscanf((char *)&str4, "%02hhX", &v1);
                float64_t v175 = __asm_vcvt_f64_s32(__asm_vmov((int32_t)v1)); // 0x133b4
                float64_t v176 = __asm_vdiv_f64(v175, __asm_vldr(0x47ae147b)); // 0x133bc
                float64_t v177 = __asm_vldr(0); // 0x133c0
                int32_t v178 = __asm_vmov_2(__asm_vsub_f64(v176, v177)); // 0x133d4
                sprintf((char *)&str5, "105,%f", (float64_t)(int64_t)v178);
                // break -> 0x15158
                break;
            }
            case 9: {
                // 0x133e4
                write(g37, (int32_t *)"01091\r", 6);
                char * buf16 = (char *)&str3;
                char * v179;
                while (true) {
                    int32_t v180 = (int32_t)buf16; // 0x134a8
                    int32_t v181 = read(g37, (int32_t *)buf16, v32 - v180); // 0x134bc
                    if (v181 <= 0) {
                        v179 = buf16;
                        // break -> 0x134d8
                        break;
                    }
                    int32_t v182 = v181 + v180; // 0x13478
                    char * v183 = (char *)v182; // 0x1347c
                    if (*(char *)(v182 - 1) == 62) {
                        v179 = v183;
                        // break -> 0x134d8
                        break;
                    }
                    buf16 = v183;
                }
                // 0x134d8
                *v179 = 0;
                sscanf((char *)&str4, "%02hhX", &v1);
                float64_t v184 = __asm_vcvt_f64_s32(__asm_vmov((int32_t)v1)); // 0x13508
                float64_t v185 = __asm_vdiv_f64(v184, __asm_vldr(0x47ae147b)); // 0x13510
                float64_t v186 = __asm_vldr(0); // 0x13514
                int32_t v187 = __asm_vmov_2(__asm_vsub_f64(v185, v186)); // 0x13528
                sprintf((char *)&str5, "103,%f", (float64_t)(int64_t)v187);
                // break -> 0x15158
                break;
            }
            case 10: {
                // 0x13538
                write(g37, (int32_t *)"010A1\r", 6);
                char * buf17 = (char *)&str3;
                char * v188;
                while (true) {
                    int32_t v189 = (int32_t)buf17; // 0x13594
                    int32_t v190 = read(g37, (int32_t *)buf17, v32 - v189); // 0x135a8
                    if (v190 <= 0) {
                        v188 = buf17;
                        // break -> 0x135c4
                        break;
                    }
                    int32_t v191 = v190 + v189; // 0x13564
                    char * v192 = (char *)v191; // 0x13568
                    if (*(char *)(v191 - 1) == 62) {
                        v188 = v192;
                        // break -> 0x135c4
                        break;
                    }
                    buf17 = v192;
                }
                // 0x135c4
                *v188 = 0;
                sscanf((char *)&str4, "%02hhX", &v1);
                sprintf((char *)&str5, "100,%d", 3 * (int32_t)v1);
                // break -> 0x15158
                break;
            }
            case 11: {
                // 0x1361c
                write(g37, (int32_t *)"010B1\r", 6);
                char * buf18 = (char *)&str3;
                bool v193; // cpsr_c
                bool v194; // cpsr_z
                char * v195;
                while (true) {
                    int32_t v196 = (int32_t)buf18; // 0x13680
                    int32_t v197 = read(g37, (int32_t *)buf18, v32 - v196); // 0x13694
                    v193 = true;
                    v194 = v197 == 0;
                    if (v197 <= 0) {
                        v195 = buf18;
                        // break -> 0x136b0
                        break;
                    }
                    int32_t v198 = v197 + v196; // 0x13650
                    char * v199 = (char *)v198; // 0x13654
                    unsigned char v200 = *(char *)(v198 - 1); // 0x13660
                    v193 = v200 >= 62;
                    v194 = v200 == 62;
                    if (v200 == 62) {
                        v195 = v199;
                        // break -> 0x136b0
                        break;
                    }
                    buf18 = v199;
                }
                // 0x136b0
                *v195 = 0;
                sscanf((char *)&str4, "%02hhX", &v1);
                float32_t v201 = __asm_vmov((int32_t)v1 - 101); // 0x136e0
                int32_t v202;
                __asm_vstr(__asm_vcvt_f32_s32(v201), v202);
                __asm_vcmpe_f32(__asm_vldr_3(v202), 0);
                int32_t v203; // apsr_nzcv
                int32_t v204; // fpscr
                __asm_vmrs(v203, v204);
                float64_t v205 = __asm_vcvt_f64_s32(__asm_vldr_3(v202)); // 0x1371c
                int32_t v206;
                if (v193 == !v194) {
                    float64_t v207 = __asm_vmul_f64(v205, __asm_vldr(0x4160f36)); // 0x13724
                    __asm_vstr(__asm_vcvt_f32_f64(v207), v206);
                } else {
                    float64_t v208 = __asm_vmul_f64(v205, __asm_vldr(-0x78811b1e)); // 0x13708
                    __asm_vstr(__asm_vcvt_f32_f64(v208), v206);
                }
                // 0x13730
                sprintf((char *)&str5, "155,%d", (int32_t)v1);
                float32_t v209 = __asm_vldr_3(v206); // 0x13750
                int32_t v210 = __asm_vmov_2(__asm_vcvt_f64_s32(v209)); // 0x13768
                int32_t str6; // bp-2056
                sprintf((char *)&str6, "22,%f", (float64_t)(int64_t)v210);
                // break -> 0x15158
                break;
            }
            case 12: {
                // 0x13778
                write(g37, (int32_t *)"010C1\r", 6);
                char * buf19 = (char *)&str3;
                char * v211;
                while (true) {
                    int32_t v212 = (int32_t)buf19; // 0x137d4
                    int32_t v213 = read(g37, (int32_t *)buf19, v32 - v212); // 0x137e8
                    if (v213 <= 0) {
                        v211 = buf19;
                        // break -> 0x13804
                        break;
                    }
                    int32_t v214 = v213 + v212; // 0x137a4
                    char * v215 = (char *)v214; // 0x137a8
                    if (*(char *)(v214 - 1) == 62) {
                        v211 = v215;
                        // break -> 0x13804
                        break;
                    }
                    buf19 = v215;
                }
                // 0x13804
                *v211 = 0;
                sscanf((char *)&str7, "%02hhX", &v2);
                sscanf((char *)&str4, "%02hhX", &v1);
                uint32_t v216 = (int32_t)v2 | 256 * (int32_t)v1; // 0x13854
                sprintf((char *)&str5, "179,%d", v216 / 4);
                // break -> 0x15158
                break;
            }
            case 13: {
                // 0x1388c
                write(g37, (int32_t *)"010D1\r", 6);
                char * buf20 = (char *)&str3;
                char * v217;
                while (true) {
                    int32_t v218 = (int32_t)buf20; // 0x13958
                    int32_t v219 = read(g37, (int32_t *)buf20, v32 - v218); // 0x1396c
                    if (v219 <= 0) {
                        v217 = buf20;
                        // break -> 0x13988
                        break;
                    }
                    int32_t v220 = v219 + v218; // 0x13928
                    char * v221 = (char *)v220; // 0x1392c
                    if (*(char *)(v220 - 1) == 62) {
                        v217 = v221;
                        // break -> 0x13988
                        break;
                    }
                    buf20 = v221;
                }
                // 0x13988
                *v217 = 0;
                sscanf((char *)&str4, "%02hhX", &v1);
                sprintf((char *)&str5, "199,%d", (int32_t)v1);
                // break -> 0x15158
                break;
            }
            case 14: {
                // 0x139d4
                write(g37, (int32_t *)"010E1\r", 6);
                char * buf21 = (char *)&str3;
                char * v222;
                while (true) {
                    int32_t v223 = (int32_t)buf21; // 0x13a30
                    int32_t v224 = read(g37, (int32_t *)buf21, v32 - v223); // 0x13a44
                    if (v224 <= 0) {
                        v222 = buf21;
                        // break -> 0x13a60
                        break;
                    }
                    int32_t v225 = v224 + v223; // 0x13a00
                    char * v226 = (char *)v225; // 0x13a04
                    if (*(char *)(v225 - 1) == 62) {
                        v222 = v226;
                        // break -> 0x13a60
                        break;
                    }
                    buf21 = v226;
                }
                // 0x13a60
                *v222 = 0;
                sscanf((char *)&str4, "%02hhX", &v1);
                sprintf((char *)&str5, "121,%f", (float64_t)(int64_t)((int32_t)(v1 / 2) - 64));
                // break -> 0x15158
                break;
            }
            case 15: {
                // 0x13ab4
                write(g37, (int32_t *)"010F1\r", 6);
                char * buf22 = (char *)&str3;
                char * v227;
                while (true) {
                    int32_t v228 = (int32_t)buf22; // 0x13b10
                    int32_t v229 = read(g37, (int32_t *)buf22, v32 - v228); // 0x13b24
                    if (v229 <= 0) {
                        v227 = buf22;
                        // break -> 0x13b40
                        break;
                    }
                    int32_t v230 = v229 + v228; // 0x13ae0
                    char * v231 = (char *)v230; // 0x13ae4
                    if (*(char *)(v230 - 1) == 62) {
                        v227 = v231;
                        // break -> 0x13b40
                        break;
                    }
                    buf22 = v231;
                }
                // 0x13b40
                *v227 = 0;
                sscanf((char *)&str4, "%02hhX", &v1);
                sprintf((char *)&str5, "135,%d", (int32_t)v1 - 40);
                // break -> 0x15158
                break;
            }
            case 16: {
                // 0x13b8c
                write(g37, (int32_t *)"01101\r", 6);
                char * buf23 = (char *)&str3;
                char * v232;
                while (true) {
                    int32_t v233 = (int32_t)buf23; // 0x13be8
                    int32_t v234 = read(g37, (int32_t *)buf23, v32 - v233); // 0x13bfc
                    if (v234 <= 0) {
                        v232 = buf23;
                        // break -> 0x13c18
                        break;
                    }
                    int32_t v235 = v234 + v233; // 0x13bb8
                    char * v236 = (char *)v235; // 0x13bbc
                    if (*(char *)(v235 - 1) == 62) {
                        v232 = v236;
                        // break -> 0x13c18
                        break;
                    }
                    buf23 = v236;
                }
                // 0x13c18
                *v232 = 0;
                sscanf((char *)&str7, "%02hhX", &v2);
                sscanf((char *)&str4, "%02hhX", &v1);
                sprintf((char *)&str5, "154,%d", ((int32_t)v2 | 256 * (int32_t)v1) / 100);
                // break -> 0x15158
                break;
            }
            case 17: {
                // 0x13c9c
                write(g37, (int32_t *)"01111\r", 6);
                char * buf24 = (char *)&str3;
                char * v237;
                while (true) {
                    int32_t v238 = (int32_t)buf24; // 0x13cf8
                    int32_t v239 = read(g37, (int32_t *)buf24, v32 - v238); // 0x13d0c
                    if (v239 <= 0) {
                        v237 = buf24;
                        // break -> 0x13d28
                        break;
                    }
                    int32_t v240 = v239 + v238; // 0x13cc8
                    char * v241 = (char *)v240; // 0x13ccc
                    if (*(char *)(v240 - 1) == 62) {
                        v237 = v241;
                        // break -> 0x13d28
                        break;
                    }
                    buf24 = v241;
                }
                // 0x13d28
                *v237 = 0;
                sscanf((char *)&str4, "%02hhX", &v1);
                float64_t v242 = __asm_vcvt_f64_s32(__asm_vmov((int32_t)v1)); // 0x13d58
                float64_t v243 = __asm_vldr(0); // 0x13d5c
                int32_t v244 = __asm_vmov_2(__asm_vmul_f64(v242, v243)); // 0x13d70
                sprintf((char *)&str5, "210,%f", (float64_t)(int64_t)v244);
                // break -> 0x15158
                break;
            }
            case 18: {
                // 0x13d80
                write(g37, (int32_t *)"01121\r", 6);
                char * buf25 = (char *)&str3;
                char * v245;
                while (true) {
                    int32_t v246 = (int32_t)buf25; // 0x13ddc
                    int32_t v247 = read(g37, (int32_t *)buf25, v32 - v246); // 0x13df0
                    if (v247 <= 0) {
                        v245 = buf25;
                        // break -> 0x13e0c
                        break;
                    }
                    int32_t v248 = v247 + v246; // 0x13dac
                    char * v249 = (char *)v248; // 0x13db0
                    if (*(char *)(v248 - 1) == 62) {
                        v245 = v249;
                        // break -> 0x13e0c
                        break;
                    }
                    buf25 = v249;
                }
                // 0x13e0c
                *v245 = 0;
                sscanf((char *)&str4, "%02hhX", &v1);
                // break -> 0x15158
                break;
            }
            case 19: {
                // 0x13e38
                write(g37, (int32_t *)"01131\r", 6);
                char * buf26 = (char *)&str3;
                char * v250;
                while (true) {
                    int32_t v251 = (int32_t)buf26; // 0x13e94
                    int32_t v252 = read(g37, (int32_t *)buf26, v32 - v251); // 0x13ea8
                    if (v252 <= 0) {
                        v250 = buf26;
                        // break -> 0x13ec4
                        break;
                    }
                    int32_t v253 = v252 + v251; // 0x13e64
                    char * v254 = (char *)v253; // 0x13e68
                    if (*(char *)(v253 - 1) == 62) {
                        v250 = v254;
                        // break -> 0x13ec4
                        break;
                    }
                    buf26 = v254;
                }
                // 0x13ec4
                *v250 = 0;
                sscanf((char *)&str4, "%02hhX", &v1);
                // break -> 0x15158
                break;
            }
            case 20: {
                // 0x13ef0
                write(g37, (int32_t *)"01141\r", 6);
                char * buf27 = (char *)&str3;
                char * v255;
                while (true) {
                    int32_t v256 = (int32_t)buf27; // 0x13f54
                    int32_t v257 = read(g37, (int32_t *)buf27, v32 - v256); // 0x13f68
                    if (v257 <= 0) {
                        v255 = buf27;
                        // break -> 0x13f84
                        break;
                    }
                    int32_t v258 = v257 + v256; // 0x13f24
                    char * v259 = (char *)v258; // 0x13f28
                    if (*(char *)(v258 - 1) == 62) {
                        v255 = v259;
                        // break -> 0x13f84
                        break;
                    }
                    buf27 = v259;
                }
                // 0x13f84
                *v255 = 0;
                sscanf((char *)&str7, "%02hhX", &v2);
                sscanf((char *)&str4, "%02hhX", &v1);
                // break -> 0x15158
                break;
            }
            case 21: {
                // 0x13fcc
                write(g37, (int32_t *)"01151\r", 6);
                char * buf28 = (char *)&str3;
                char * v260;
                while (true) {
                    int32_t v261 = (int32_t)buf28; // 0x14028
                    int32_t v262 = read(g37, (int32_t *)buf28, v32 - v261); // 0x1403c
                    if (v262 <= 0) {
                        v260 = buf28;
                        // break -> 0x14058
                        break;
                    }
                    int32_t v263 = v262 + v261; // 0x13ff8
                    char * v264 = (char *)v263; // 0x13ffc
                    if (*(char *)(v263 - 1) == 62) {
                        v260 = v264;
                        // break -> 0x14058
                        break;
                    }
                    buf28 = v264;
                }
                // 0x14058
                *v260 = 0;
                sscanf((char *)&str7, "%02hhX", &v2);
                sscanf((char *)&str4, "%02hhX", &v1);
                // break -> 0x15158
                break;
            }
            case 22: {
                // 0x140a0
                write(g37, (int32_t *)"01161\r", 6);
                char * buf29 = (char *)&str3;
                char * v265;
                while (true) {
                    int32_t v266 = (int32_t)buf29; // 0x140fc
                    int32_t v267 = read(g37, (int32_t *)buf29, v32 - v266); // 0x14110
                    if (v267 <= 0) {
                        v265 = buf29;
                        // break -> 0x14180
                        break;
                    }
                    int32_t v268 = v267 + v266; // 0x140cc
                    char * v269 = (char *)v268; // 0x140d0
                    if (*(char *)(v268 - 1) == 62) {
                        v265 = v269;
                        // break -> 0x14180
                        break;
                    }
                    buf29 = v269;
                }
                // 0x14180
                *v265 = 0;
                sscanf((char *)&str7, "%02hhX", &v2);
                sscanf((char *)&str4, "%02hhX", &v1);
                // break -> 0x15158
                break;
            }
            case 23: {
                // 0x141c8
                write(g37, (int32_t *)"01171\r", 6);
                char * buf30 = (char *)&str3;
                char * v270;
                while (true) {
                    int32_t v271 = (int32_t)buf30; // 0x14224
                    int32_t v272 = read(g37, (int32_t *)buf30, v32 - v271); // 0x14238
                    if (v272 <= 0) {
                        v270 = buf30;
                        // break -> 0x14254
                        break;
                    }
                    int32_t v273 = v272 + v271; // 0x141f4
                    char * v274 = (char *)v273; // 0x141f8
                    if (*(char *)(v273 - 1) == 62) {
                        v270 = v274;
                        // break -> 0x14254
                        break;
                    }
                    buf30 = v274;
                }
                // 0x14254
                *v270 = 0;
                sscanf((char *)&str7, "%02hhX", &v2);
                sscanf((char *)&str4, "%02hhX", &v1);
                // break -> 0x15158
                break;
            }
            case 24: {
                // 0x1429c
                write(g37, (int32_t *)"01181\r", 6);
                char * buf31 = (char *)&str3;
                char * v275;
                while (true) {
                    int32_t v276 = (int32_t)buf31; // 0x142f8
                    int32_t v277 = read(g37, (int32_t *)buf31, v32 - v276); // 0x1430c
                    if (v277 <= 0) {
                        v275 = buf31;
                        // break -> 0x14328
                        break;
                    }
                    int32_t v278 = v277 + v276; // 0x142c8
                    char * v279 = (char *)v278; // 0x142cc
                    if (*(char *)(v278 - 1) == 62) {
                        v275 = v279;
                        // break -> 0x14328
                        break;
                    }
                    buf31 = v279;
                }
                // 0x14328
                *v275 = 0;
                sscanf((char *)&str7, "%02hhX", &v2);
                sscanf((char *)&str4, "%02hhX", &v1);
                // break -> 0x15158
                break;
            }
            case 25: {
                // 0x14370
                write(g37, (int32_t *)"01191\r", 6);
                char * buf32 = (char *)&str3;
                char * v280;
                while (true) {
                    int32_t v281 = (int32_t)buf32; // 0x143cc
                    int32_t v282 = read(g37, (int32_t *)buf32, v32 - v281); // 0x143e0
                    if (v282 <= 0) {
                        v280 = buf32;
                        // break -> 0x143fc
                        break;
                    }
                    int32_t v283 = v282 + v281; // 0x1439c
                    char * v284 = (char *)v283; // 0x143a0
                    if (*(char *)(v283 - 1) == 62) {
                        v280 = v284;
                        // break -> 0x143fc
                        break;
                    }
                    buf32 = v284;
                }
                // 0x143fc
                *v280 = 0;
                sscanf((char *)&str7, "%02hhX", &v2);
                sscanf((char *)&str4, "%02hhX", &v1);
                // break -> 0x15158
                break;
            }
            case 26: {
                // 0x14444
                write(g37, (int32_t *)"011A1\r", 6);
                char * buf33 = (char *)&str3;
                char * v285;
                while (true) {
                    int32_t v286 = (int32_t)buf33; // 0x144a0
                    int32_t v287 = read(g37, (int32_t *)buf33, v32 - v286); // 0x144b4
                    if (v287 <= 0) {
                        v285 = buf33;
                        // break -> 0x144d0
                        break;
                    }
                    int32_t v288 = v287 + v286; // 0x14470
                    char * v289 = (char *)v288; // 0x14474
                    if (*(char *)(v288 - 1) == 62) {
                        v285 = v289;
                        // break -> 0x144d0
                        break;
                    }
                    buf33 = v289;
                }
                // 0x144d0
                *v285 = 0;
                sscanf((char *)&str7, "%02hhX", &v2);
                sscanf((char *)&str4, "%02hhX", &v1);
                // break -> 0x15158
                break;
            }
            case 27: {
                // 0x14518
                write(g37, (int32_t *)"011B1\r", 6);
                char * buf34 = (char *)&str3;
                char * v290;
                while (true) {
                    int32_t v291 = (int32_t)buf34; // 0x14574
                    int32_t v292 = read(g37, (int32_t *)buf34, v32 - v291); // 0x14588
                    if (v292 <= 0) {
                        v290 = buf34;
                        // break -> 0x145a4
                        break;
                    }
                    int32_t v293 = v292 + v291; // 0x14544
                    char * v294 = (char *)v293; // 0x14548
                    if (*(char *)(v293 - 1) == 62) {
                        v290 = v294;
                        // break -> 0x145a4
                        break;
                    }
                    buf34 = v294;
                }
                // 0x145a4
                *v290 = 0;
                sscanf((char *)&str7, "%02hhX", &v2);
                sscanf((char *)&str4, "%02hhX", &v1);
                // break -> 0x15158
                break;
            }
            case 28: {
                // 0x145ec
                write(g37, (int32_t *)"011C1\r", 6);
                char * buf35 = (char *)&str3;
                char * v295;
                while (true) {
                    int32_t v296 = (int32_t)buf35; // 0x14648
                    int32_t v297 = read(g37, (int32_t *)buf35, v32 - v296); // 0x1465c
                    if (v297 <= 0) {
                        v295 = buf35;
                        // break -> 0x14678
                        break;
                    }
                    int32_t v298 = v297 + v296; // 0x14618
                    char * v299 = (char *)v298; // 0x1461c
                    if (*(char *)(v298 - 1) == 62) {
                        v295 = v299;
                        // break -> 0x14678
                        break;
                    }
                    buf35 = v299;
                }
                // 0x14678
                *v295 = 0;
                sscanf((char *)&str7, "%02hhX", &v2);
                sscanf((char *)&str4, "%02hhX", &v1);
                // break -> 0x15158
                break;
            }
            case 29: {
                // 0x146c0
                write(g37, (int32_t *)"011D1\r", 6);
                char * buf36 = (char *)&str3;
                char * v300;
                while (true) {
                    int32_t v301 = (int32_t)buf36; // 0x1471c
                    int32_t v302 = read(g37, (int32_t *)buf36, v32 - v301); // 0x14730
                    if (v302 <= 0) {
                        v300 = buf36;
                        // break -> 0x1474c
                        break;
                    }
                    int32_t v303 = v302 + v301; // 0x146ec
                    char * v304 = (char *)v303; // 0x146f0
                    if (*(char *)(v303 - 1) == 62) {
                        v300 = v304;
                        // break -> 0x1474c
                        break;
                    }
                    buf36 = v304;
                }
                // 0x1474c
                *v300 = 0;
                sscanf((char *)&str7, "%02hhX", &v2);
                sscanf((char *)&str4, "%02hhX", &v1);
                // break -> 0x15158
                break;
            }
            case 92: {
                // 0x14868
                write(g37, (int32_t *)"015C1\r", 6);
                char * buf37 = (char *)&str3;
                char * v305;
                while (true) {
                    int32_t v306 = (int32_t)buf37; // 0x148c4
                    int32_t v307 = read(g37, (int32_t *)buf37, v32 - v306); // 0x148d8
                    if (v307 <= 0) {
                        v305 = buf37;
                        // break -> 0x148f4
                        break;
                    }
                    int32_t v308 = v307 + v306; // 0x14894
                    char * v309 = (char *)v308; // 0x14898
                    if (*(char *)(v308 - 1) == 62) {
                        v305 = v309;
                        // break -> 0x148f4
                        break;
                    }
                    buf37 = v309;
                }
                // 0x148f4
                *v305 = 0;
                sscanf((char *)&str4, "%02hhX", &v1);
                sprintf((char *)&str5, "31,%d", (int32_t)v1 - 40);
                // break -> 0x15158
                break;
            }
            case 31: {
                // 0x14794
                write(g37, (int32_t *)"011F1\r", 6);
                char * buf38 = (char *)&str3;
                char * v310;
                while (true) {
                    int32_t v311 = (int32_t)buf38; // 0x147f0
                    int32_t v312 = read(g37, (int32_t *)buf38, v32 - v311); // 0x14804
                    if (v312 <= 0) {
                        v310 = buf38;
                        // break -> 0x14820
                        break;
                    }
                    int32_t v313 = v312 + v311; // 0x147c0
                    char * v314 = (char *)v313; // 0x147c4
                    if (*(char *)(v313 - 1) == 62) {
                        v310 = v314;
                        // break -> 0x14820
                        break;
                    }
                    buf38 = v314;
                }
                // 0x14820
                *v310 = 0;
                sscanf((char *)&str7, "%02hhX", &v2);
                sscanf((char *)&str4, "%02hhX", &v1);
                // break -> 0x15158
                break;
            }
            case 70: {
                // 0x14ea8
                write(g37, (int32_t *)"01461\r", 6);
                char * buf39 = (char *)&str3;
                char * v315;
                while (true) {
                    int32_t v316 = (int32_t)buf39; // 0x14f04
                    int32_t v317 = read(g37, (int32_t *)buf39, v32 - v316); // 0x14f18
                    if (v317 <= 0) {
                        v315 = buf39;
                        // break -> 0x14f34
                        break;
                    }
                    int32_t v318 = v317 + v316; // 0x14ed4
                    char * v319 = (char *)v318; // 0x14ed8
                    if (*(char *)(v318 - 1) == 62) {
                        v315 = v319;
                        // break -> 0x14f34
                        break;
                    }
                    buf39 = v319;
                }
                // 0x14f34
                *v315 = 0;
                sscanf((char *)&str4, "%02hhX", &v1);
                sprintf((char *)&str5, "9,%d", (int32_t)v1 - 40);
                // break -> 0x15158
                break;
            }
            case 60: {
                // 0x14f80
                write(g37, (int32_t *)"013C1\r", 6);
                char * buf40 = (char *)&str3;
                char * v320;
                while (true) {
                    int32_t v321 = (int32_t)buf40; // 0x14fdc
                    int32_t v322 = read(g37, (int32_t *)buf40, v32 - v321); // 0x14ff0
                    if (v322 <= 0) {
                        v320 = buf40;
                        // break -> 0x1500c
                        break;
                    }
                    int32_t v323 = v322 + v321; // 0x14fac
                    char * v324 = (char *)v323; // 0x14fb0
                    if (*(char *)(v323 - 1) == 62) {
                        v320 = v324;
                        // break -> 0x1500c
                        break;
                    }
                    buf40 = v324;
                }
                // 0x1500c
                *v320 = 0;
                sscanf((char *)&str7, "%02hhX", &v2);
                sscanf((char *)&str4, "%02hhX", &v1);
                float64_t v325 = __asm_vcvt_f64_s32(__asm_vmov((int32_t)v2 | 256 * (int32_t)v1)); // 0x15064
                float64_t v326 = __asm_vmul_f64(v325, __asm_vldr(-0x66666666)); // 0x1506c
                float64_t v327 = __asm_vldr(0); // 0x15070
                int32_t v328 = __asm_vmov_2(__asm_vsub_f64(v326, v327)); // 0x15084
                sprintf((char *)&str5, "277,%f", (float64_t)(int64_t)v328);
                // break -> 0x15158
                break;
            }
            case 55: {
                // 0x14d30
                write(g37, (int32_t *)"01371\r", 6);
                char * buf41 = (char *)&str3;
                char * v329;
                while (true) {
                    int32_t v330 = (int32_t)buf41; // 0x14d8c
                    int32_t v331 = read(g37, (int32_t *)buf41, v32 - v330); // 0x14da0
                    if (v331 <= 0) {
                        v329 = buf41;
                        // break -> 0x14de4
                        break;
                    }
                    int32_t v332 = v331 + v330; // 0x14d5c
                    char * v333 = (char *)v332; // 0x14d60
                    if (*(char *)(v332 - 1) == 62) {
                        v329 = v333;
                        // break -> 0x14de4
                        break;
                    }
                    buf41 = v333;
                }
                // 0x14de4
                *v329 = 0;
                sscanf((char *)&str8, "%02hhX", &v4);
                sscanf((char *)&str9, "%02hhX", &v3);
                sscanf((char *)&str7, "%02hhX", &v2);
                sscanf((char *)&str4, "%02hhX", &v1);
                float64_t v334 = __asm_vcvt_f64_s32(__asm_vmov((int32_t)v2 | 256 * (int32_t)v1)); // 0x14e70
                float64_t v335 = __asm_vmul_f64(v334, __asm_vldr(0)); // 0x14e78
                int32_t v336;
                __asm_vstr(__asm_vcvt_f32_f64(v335), v336);
                float32_t v337 = __asm_vldr_3(v336); // 0x14e84
                int32_t v338 = __asm_vmov_2(__asm_vcvt_f64_s32(v337)); // 0x14e98
                sprintf((char *)&str5, "145,%f", (float64_t)(int64_t)v338);
                // break -> 0x15158
                break;
            }
            case 54: {
                // 0x14be0
                write(g37, (int32_t *)"01361\r", 6);
                char * buf42 = (char *)&str3;
                char * v339;
                while (true) {
                    int32_t v340 = (int32_t)buf42; // 0x14c3c
                    int32_t v341 = read(g37, (int32_t *)buf42, v32 - v340); // 0x14c50
                    if (v341 <= 0) {
                        v339 = buf42;
                        // break -> 0x14c6c
                        break;
                    }
                    int32_t v342 = v341 + v340; // 0x14c0c
                    char * v343 = (char *)v342; // 0x14c10
                    if (*(char *)(v342 - 1) == 62) {
                        v339 = v343;
                        // break -> 0x14c6c
                        break;
                    }
                    buf42 = v343;
                }
                // 0x14c6c
                *v339 = 0;
                sscanf((char *)&str8, "%02hhX", &v4);
                sscanf((char *)&str9, "%02hhX", &v3);
                sscanf((char *)&str7, "%02hhX", &v2);
                sscanf((char *)&str4, "%02hhX", &v1);
                float64_t v344 = __asm_vcvt_f64_s32(__asm_vmov((int32_t)v2 | 256 * (int32_t)v1)); // 0x14cf8
                float64_t v345 = __asm_vmul_f64(v344, __asm_vldr(0)); // 0x14d00
                int32_t v346;
                __asm_vstr(__asm_vcvt_f32_f64(v345), v346);
                float32_t v347 = __asm_vldr_3(v346); // 0x14d0c
                int32_t v348 = __asm_vmov_2(__asm_vcvt_f64_s32(v347)); // 0x14d20
                sprintf((char *)&str5, "144,%f", (float64_t)(int64_t)v348);
                // break -> 0x15158
                break;
            }
            case 53: {
                // 0x14a90
                write(g37, (int32_t *)"01351\r", 6);
                char * buf43 = (char *)&str3;
                char * v349;
                while (true) {
                    int32_t v350 = (int32_t)buf43; // 0x14aec
                    int32_t v351 = read(g37, (int32_t *)buf43, v32 - v350); // 0x14b00
                    if (v351 <= 0) {
                        v349 = buf43;
                        // break -> 0x14b1c
                        break;
                    }
                    int32_t v352 = v351 + v350; // 0x14abc
                    char * v353 = (char *)v352; // 0x14ac0
                    if (*(char *)(v352 - 1) == 62) {
                        v349 = v353;
                        // break -> 0x14b1c
                        break;
                    }
                    buf43 = v353;
                }
                // 0x14b1c
                *v349 = 0;
                sscanf((char *)&str8, "%02hhX", &v4);
                sscanf((char *)&str9, "%02hhX", &v3);
                sscanf((char *)&str7, "%02hhX", &v2);
                sscanf((char *)&str4, "%02hhX", &v1);
                float64_t v354 = __asm_vcvt_f64_s32(__asm_vmov((int32_t)v2 | 256 * (int32_t)v1)); // 0x14ba8
                float64_t v355 = __asm_vmul_f64(v354, __asm_vldr(0)); // 0x14bb0
                int32_t v356;
                __asm_vstr(__asm_vcvt_f32_f64(v355), v356);
                float32_t v357 = __asm_vldr_3(v356); // 0x14bbc
                int32_t v358 = __asm_vmov_2(__asm_vcvt_f64_s32(v357)); // 0x14bd0
                sprintf((char *)&str5, "143,%f", (float64_t)(int64_t)v358);
                // break -> 0x15158
                break;
            }
            case 52: {
                // 0x14940
                write(g37, (int32_t *)"01341\r", 6);
                char * buf44 = (char *)&str3;
                char * v359;
                while (true) {
                    int32_t v360 = (int32_t)buf44; // 0x1499c
                    int32_t v361 = read(g37, (int32_t *)buf44, v32 - v360); // 0x149b0
                    if (v361 <= 0) {
                        v359 = buf44;
                        // break -> 0x149cc
                        break;
                    }
                    int32_t v362 = v361 + v360; // 0x1496c
                    char * v363 = (char *)v362; // 0x14970
                    if (*(char *)(v362 - 1) == 62) {
                        v359 = v363;
                        // break -> 0x149cc
                        break;
                    }
                    buf44 = v363;
                }
                // 0x149cc
                *v359 = 0;
                sscanf((char *)&str8, "%02hhX", &v4);
                sscanf((char *)&str9, "%02hhX", &v3);
                sscanf((char *)&str7, "%02hhX", &v2);
                sscanf((char *)&str4, "%02hhX", &v1);
                float64_t v364 = __asm_vcvt_f64_s32(__asm_vmov((int32_t)v2 | 256 * (int32_t)v1)); // 0x14a58
                float64_t v365 = __asm_vmul_f64(v364, __asm_vldr(0)); // 0x14a60
                int32_t v366;
                __asm_vstr(__asm_vcvt_f32_f64(v365), v366);
                float32_t v367 = __asm_vldr_3(v366); // 0x14a6c
                int32_t v368 = __asm_vmov_2(__asm_vcvt_f64_s32(v367)); // 0x14a80
                sprintf((char *)&str5, "142,%f", (float64_t)(int64_t)v368);
                // break -> 0x15158
                break;
            }
        }
        uint32_t v369 = 0;
        while (true) {
            // 0x15158
            if (v369 >= 1) {
                // break -> 0x15168
                break;
            }
            int32_t message = 64 * v369 + (int32_t)&str5; // 0x150b8
            char * str10 = (char *)message; // 0x150bc
            printf("sending %s\n", str10);
            int32_t len = strlen(str10); // 0x15104
            int32_t v370 = sendto(g38, (int32_t *)message, len, 0, (struct sockaddr *)&g34, g28); // 0x1512c
            if (v370 == -1) {
                // break (via goto) -> 0x1513c
                goto lab_0x1513c;
            }
            v369++;
        }
        // 0x15168
        v138 = v138 != 1;
        v136 = v137;
    }
  lab_0x1513c:
    // 0x1513c
    printf((char *)&g27);
    die("sendto()");
    // UNREACHABLE
  lab_0x10d08:;
    // 0x10d08
    int32_t endptr2; // bp-2356
    char * next_token4; // 0x10cfc
    int32_t v371 = strtoimax(next_token4, (char **)&endptr2, 0); // 0x10d20
    int32_t v372;
    *(char *)(v372 + v6) = (char)v371;
    int32_t v373 = v372 + 1; // 0x10d50
    char * next_token3 = strtok(NULL, "-"); // 0x10d60
    if (next_token3 == NULL) {
        v5 = v373;
        goto lab_0x10d74_2;
    } else {
        next_token4 = next_token3;
        v372 = v373;
        goto lab_0x10d08;
    }
  lab_0x12d10:
    // 0x12d10
    v35 = v51;
    v36 = v61;
    v37 = v63;
    goto lab_0x11034_2;
  lab_0x1295c:
    // 0x1295c
    *v56 = 0;
    int32_t v374;
    if (strstr((char *)&str3, "41") != NULL) {
        // 0x12984
        sscanf((char *)&str4, "%02hhX", &v1);
        sscanf((char *)&str7, "%02hhX", &v2);
        sscanf((char *)&str9, "%02hhX", &v3);
        sscanf((char *)&str8, "%02hhX", &v4);
        printf((char *)&g17);
        int32_t v375 = 7;
        int32_t v376 = v62;
        while (true) {
            int32_t v377 = v375 - 1; // 0x12a1c
            if (((int32_t)v1 >> v375) % 2 != 0) {
                // 0x12a3c
                fprintf(g30, "0x%02X", v376);
                fputc(44, g30);
                printf((char *)&g18);
            }
            int32_t v378 = v376 + 1; // 0x12a84
            printf((char *)&g20);
            if (v375 < 1) {
                // break -> 0x12ab0
                break;
            }
            v375 = v377;
            v376 = v378;
        }
        // 0x12ab0
        printf((char *)&g21);
        int32_t v379 = 7;
        int32_t v380 = v62 + 8;
        while (true) {
            int32_t v381 = v379 - 1; // 0x12adc
            if (((int32_t)v2 >> v379) % 2 != 0) {
                // 0x12afc
                fprintf(g30, "0x%02X", v380);
                fputc(44, g30);
                printf((char *)&g18);
            }
            int32_t v382 = v380 + 1; // 0x12b44
            printf((char *)&g20);
            if (v379 < 1) {
                // break -> 0x12b70
                break;
            }
            v379 = v381;
            v380 = v382;
        }
        // 0x12b70
        printf((char *)&g22);
        int32_t v383 = 7;
        int32_t v384 = v62 + 16;
        while (true) {
            int32_t v385 = v383 - 1; // 0x12b9c
            if (((int32_t)v3 >> v383) % 2 != 0) {
                // 0x12bc4
                fprintf(g30, "0x%02X", v384);
                fputc(44, g30);
                printf((char *)&g18);
            }
            int32_t v386 = v384 + 1; // 0x12c0c
            printf((char *)&g20);
            if (v383 < 1) {
                // break -> 0x12c38
                break;
            }
            v383 = v385;
            v384 = v386;
        }
        // 0x12c38
        printf((char *)&g23);
        int32_t v387 = 7;
        int32_t v388 = v62 + 24;
        while (true) {
            int32_t v389 = v387 - 1; // 0x12c64
            if (((int32_t)v4 >> v387) % 2 != 0) {
                // 0x12c84
                fprintf(g30, "0x%02X", v388);
                fputc(44, g30);
                printf((char *)&g18);
            }
            int32_t v390 = v388 + 1; // 0x12ccc
            printf((char *)&g20);
            if (v387 < 1) {
                // break -> 0x12cf8
                break;
            }
            v387 = v389;
            v388 = v390;
        }
        // 0x12cf8
        v374 = v62 + 32;
    } else {
        v374 = v62;
    }
    // 0x12d10
    fclose(g30);
    if (v60 != 0) {
        // break (via goto) -> 0x15168
        goto lab_0x15168;
    }
    v62 = v374;
    goto lab_0x11034;
  lab_0x10d74_2:
    while (true) {
        while (true) {
            // 0x10d74
            int32_t str11; // bp-2352
            if (fgets((char *)&str11, 100, file) == NULL) {
                // break (via goto) -> 0x10d98
                goto lab_0x10d98;
            }
            // 0x10cec
            next_token4 = strtok((char *)&str11, "-");
            if (next_token4 != NULL) {
                v372 = v5;
                goto lab_0x10d08;
            }
        }
    }
    goto lab_0x10d98;
  lab_0x111cc:
    // 0x111cc
    *v52 = 0;
    v63 = v37;
    v61 = v36;
    v51 = v44;
    goto lab_0x12d10;
  lab_0x11168:
    // 0x11168
    printf((char *)&g10);
    v52 = v98;
    v44 = 2;
    goto lab_0x111cc;
  lab_0x11104:;
    // 0x11104
    int32_t v391;
    if (v88 == 13) {
        v391 = v64;
        goto lab_0x11144;
    } else {
        // 0x1111c
        *(char *)(v34 + v64) = *v78;
        v391 = v64 + 1;
        goto lab_0x11144;
    }
  lab_0x11144:;
    int32_t v392 = v77 + 1; // 0x11148
    char * v393 = (char *)(v392 + v30); // 0x1115c
    if (*v393 == 16) {
        goto lab_0x11168;
    } else {
        // 0x11144
        v88 = *v393;
        v78 = v393;
        v64 = v391;
        v77 = v392;
        goto lab_0x11104;
    }
  lab_0x112c0:
    // 0x112c0
    printf((char *)&g10);
    v63 = v37;
    v61 = v36;
    v51 = 3;
    goto lab_0x12d10;
  lab_0x1125c:;
    // 0x1125c
    int32_t v394;
    if (v89 == 13) {
        v394 = v65;
        goto lab_0x1129c;
    } else {
        // 0x11274
        *(char *)(v34 + v65) = *v79;
        v394 = v65 + 1;
        goto lab_0x1129c;
    }
  lab_0x1129c:;
    int32_t v395 = v76 + 1; // 0x112a0
    char * v396 = (char *)(v395 + v30); // 0x112b4
    if (*v396 == 16) {
        goto lab_0x112c0;
    } else {
        // 0x1129c
        v89 = *v396;
        v79 = v396;
        v65 = v394;
        v76 = v395;
        goto lab_0x1125c;
    }
  lab_0x1140c:
    // 0x1140c
    printf((char *)&g10);
    v63 = v37;
    v61 = v36;
    v51 = 4;
    goto lab_0x12d10;
  lab_0x113a8:;
    // 0x113a8
    int32_t v397;
    if (v90 == 13) {
        v397 = v66;
        goto lab_0x113e8;
    } else {
        // 0x113c0
        *(char *)(v34 + v66) = *v80;
        v397 = v66 + 1;
        goto lab_0x113e8;
    }
  lab_0x113e8:;
    int32_t v398 = v75 + 1; // 0x113ec
    char * v399 = (char *)(v398 + v30); // 0x11400
    if (*v399 == 16) {
        goto lab_0x1140c;
    } else {
        // 0x113e8
        v90 = *v399;
        v80 = v399;
        v66 = v397;
        v75 = v398;
        goto lab_0x113a8;
    }
  lab_0x115bc:
    // 0x115bc
    *v57 = 0;
    v63 = v37;
    v61 = v36;
    v51 = v45;
    goto lab_0x12d10;
  lab_0x11558:
    // 0x11558
    printf((char *)&g10);
    v57 = v99;
    v45 = 5;
    goto lab_0x115bc;
  lab_0x114f4:;
    // 0x114f4
    int32_t v400;
    if (v91 == 13) {
        v400 = v67;
        goto lab_0x11534;
    } else {
        // 0x1150c
        *(char *)(v34 + v67) = *v81;
        v400 = v67 + 1;
        goto lab_0x11534;
    }
  lab_0x11534:;
    int32_t v401 = v74 + 1; // 0x11538
    char * v402 = (char *)(v401 + v30); // 0x1154c
    if (*v402 == 16) {
        goto lab_0x11558;
    } else {
        // 0x11534
        v91 = *v402;
        v81 = v402;
        v67 = v400;
        v74 = v401;
        goto lab_0x114f4;
    }
  lab_0x11714:
    // 0x11714
    *v58 = 0;
    v63 = v37;
    v61 = v36;
    v51 = v46;
    goto lab_0x12d10;
  lab_0x116b0:
    // 0x116b0
    printf((char *)&g10);
    v58 = v100;
    v46 = 6;
    goto lab_0x11714;
  lab_0x1164c:;
    // 0x1164c
    int32_t v403;
    if (v92 == 13) {
        v403 = v38;
        goto lab_0x1168c;
    } else {
        // 0x11664
        *(char *)(v34 + v38) = *v82;
        v403 = v38 + 1;
        goto lab_0x1168c;
    }
  lab_0x1168c:;
    int32_t v404 = v73 + 1; // 0x11690
    char * v405 = (char *)(v404 + v30); // 0x116a4
    if (*v405 == 16) {
        goto lab_0x116b0;
    } else {
        // 0x1168c
        v92 = *v405;
        v82 = v405;
        v38 = v403;
        v73 = v404;
        goto lab_0x1164c;
    }
  lab_0x1186c:
    // 0x1186c
    *v59 = 0;
    v63 = v37;
    v61 = v36;
    v51 = v47;
    goto lab_0x12d10;
  lab_0x11808:
    // 0x11808
    printf((char *)&g10);
    v59 = v101;
    v47 = 7;
    goto lab_0x1186c;
  lab_0x117a4:;
    // 0x117a4
    int32_t v406;
    if (v93 == 13) {
        v406 = v39;
        goto lab_0x117e4;
    } else {
        // 0x117bc
        *(char *)(v34 + v39) = *v83;
        v406 = v39 + 1;
        goto lab_0x117e4;
    }
  lab_0x117e4:;
    int32_t v407 = v72 + 1; // 0x117e8
    char * v408 = (char *)(v407 + v30); // 0x117fc
    if (*v408 == 16) {
        goto lab_0x11808;
    } else {
        // 0x117e4
        v93 = *v408;
        v83 = v408;
        v39 = v406;
        v72 = v407;
        goto lab_0x117a4;
    }
  lab_0x11990:
    // 0x11990
    printf((char *)&g10);
    *v53 = 0;
    if (strstr((char *)&str3, "41") != NULL) {
        // 0x119c8
        int32_t str12; // bp-480
        sscanf((char *)&str12, "%02hhX", &v1);
        int32_t str13; // bp-478
        sscanf((char *)&str13, "%02hhX", &v2);
        int32_t str14; // bp-476
        sscanf((char *)&str14, "%02hhX", &v3);
        int32_t str15; // bp-474
        sscanf((char *)&str15, "%02hhX", &v4);
        printf((char *)&g17);
        int32_t v409 = 7;
        int32_t v410 = v36;
        int32_t v411 = v37;
        int32_t v412;
        while (true) {
            int32_t v413 = v409 - 1; // 0x11ba4
            if (((int32_t)v1 >> v409) % 2 != 0) {
                // 0x11bc4
                if (v411 >= 4) {
                    // 0x11bd0
                    fprintf(g30, "0x%02X", v411);
                    fputc(44, g30);
                    printf((char *)&g18);
                    printf((char *)&g19);
                    v412 = v410 + 1;
                } else {
                    v412 = v410;
                }
            } else {
                v412 = v410;
            }
            int32_t v414 = v411 + 1; // 0x11c24
            printf((char *)&g20);
            if (v409 < 1) {
                // break -> 0x11c50
                break;
            }
            v409 = v413;
            v410 = v412;
            v411 = v414;
        }
        // 0x11c50
        printf((char *)&g21);
        int32_t v415 = 7;
        int32_t v416 = v412;
        int32_t v417 = v37 + 8;
        int32_t v418;
        while (true) {
            int32_t v419 = v415 - 1; // 0x11c7c
            if (((int32_t)v2 >> v415) % 2 != 0) {
                // 0x11c9c
                fprintf(g30, "0x%02X", v417);
                fputc(44, g30);
                printf((char *)&g18);
                v418 = v416 + 1;
            } else {
                v418 = v416;
            }
            int32_t v420 = v417 + 1; // 0x11ce4
            printf((char *)&g20);
            if (v415 < 1) {
                // break -> 0x11d10
                break;
            }
            v415 = v419;
            v416 = v418;
            v417 = v420;
        }
        // 0x11d10
        printf((char *)&g22);
        int32_t v421 = 7;
        int32_t v422 = v418;
        int32_t v423 = v37 + 16;
        int32_t v424;
        while (true) {
            int32_t v425 = v421 - 1; // 0x11d3c
            if (((int32_t)v3 >> v421) % 2 != 0) {
                // 0x11d64
                fprintf(g30, "0x%02X", v423);
                fputc(44, g30);
                printf((char *)&g18);
                v424 = v422 + 1;
            } else {
                v424 = v422;
            }
            int32_t v426 = v423 + 1; // 0x11dac
            printf((char *)&g20);
            if (v421 < 1) {
                // break -> 0x11dd8
                break;
            }
            v421 = v425;
            v422 = v424;
            v423 = v426;
        }
        // 0x11dd8
        printf((char *)&g23);
        int32_t v427 = 7;
        int32_t v428 = v424;
        int32_t v429 = v37 + 24;
        int32_t v430;
        while (true) {
            int32_t v431 = v427 - 1; // 0x11e04
            if (((int32_t)v4 >> v427) % 2 != 0) {
                // 0x11e24
                if (v429 <= 28) {
                    // 0x11e30
                    fprintf(g30, "0x%02X", v429);
                    fputc(44, g30);
                    printf((char *)&g18);
                    v430 = v428 + 1;
                } else {
                    v430 = v428;
                }
            } else {
                v430 = v428;
            }
            int32_t v432 = v429 + 1; // 0x11e78
            printf((char *)&g20);
            if (v427 < 1) {
                // break -> 0x12d10
                break;
            }
            v427 = v431;
            v428 = v430;
            v429 = v432;
        }
        // 0x12d10
        v63 = v37 + 32;
        v61 = v430;
        v51 = v48;
    } else {
        v63 = v37;
        v61 = v36;
        v51 = v48;
    }
    goto lab_0x12d10;
  lab_0x118e0:;
    // 0x118e0
    int32_t v433;
    if (v94 == 13) {
        v433 = v40;
        goto lab_0x11920;
    } else {
        // 0x118f8
        *(char *)(v34 + v40) = *v84;
        v433 = v40 + 1;
        goto lab_0x11920;
    }
  lab_0x11920:;
    int32_t v434 = v71 + 1; // 0x11924
    char * v435 = (char *)(v434 + v30); // 0x11938
    if (*v435 == 16) {
        v53 = v102;
        v48 = 8;
        goto lab_0x11990;
    } else {
        // 0x11920
        v94 = *v435;
        v84 = v435;
        v40 = v433;
        v71 = v434;
        goto lab_0x118e0;
    }
  lab_0x11f70:
    // 0x11f70
    printf((char *)&g10);
    v54 = v103;
    v49 = 9;
    goto lab_0x11fcc;
  lab_0x11f0c:;
    // 0x11f0c
    int32_t v462;
    if (v95 == 13) {
        v462 = v41;
        goto lab_0x11f4c;
    } else {
        // 0x11f24
        *(char *)(v34 + v41) = *v85;
        v462 = v41 + 1;
        goto lab_0x11f4c;
    }
  lab_0x11fcc:
    // 0x11fcc
    *v54 = 0;
    if (strstr((char *)&str3, "41") != NULL) {
        // 0x11ff4
        sscanf((char *)&str4, "%02hhX", &v1);
        sscanf((char *)&str7, "%02hhX", &v2);
        sscanf((char *)&str9, "%02hhX", &v3);
        sscanf((char *)&str8, "%02hhX", &v4);
        printf((char *)&g17);
        int32_t v436 = 7;
        int32_t v437 = v36;
        int32_t v438 = v37;
        int32_t v439;
        while (true) {
            int32_t v440 = v436 - 1; // 0x1208c
            if (((int32_t)v1 >> v436) % 2 != 0) {
                // 0x120ac
                fprintf(g30, "0x%02X", v438);
                fputc(44, g30);
                printf((char *)&g18);
                v439 = v437 + 1;
            } else {
                v439 = v437;
            }
            int32_t v441 = v438 + 1; // 0x120f4
            printf((char *)&g20);
            if (v436 < 1) {
                // break -> 0x12120
                break;
            }
            v436 = v440;
            v437 = v439;
            v438 = v441;
        }
        // 0x12120
        printf((char *)&g21);
        int32_t v442 = 7;
        int32_t v443 = v439;
        int32_t v444 = v37 + 8;
        int32_t v445;
        while (true) {
            int32_t v446 = v442 - 1; // 0x1214c
            if (((int32_t)v2 >> v442) % 2 != 0) {
                // 0x1216c
                fprintf(g30, "0x%02X", v444);
                fputc(44, g30);
                printf((char *)&g18);
                v445 = v443 + 1;
            } else {
                v445 = v443;
            }
            int32_t v447 = v444 + 1; // 0x121b4
            printf((char *)&g20);
            if (v442 < 1) {
                // break -> 0x121e0
                break;
            }
            v442 = v446;
            v443 = v445;
            v444 = v447;
        }
        // 0x121e0
        printf((char *)&g22);
        int32_t v448 = 7;
        int32_t v449 = v445;
        int32_t v450 = v37 + 16;
        int32_t v451;
        while (true) {
            int32_t v452 = v448 - 1; // 0x1220c
            if (((int32_t)v3 >> v448) % 2 != 0) {
                // 0x12234
                fprintf(g30, "0x%02X", v450);
                fputc(44, g30);
                printf((char *)&g18);
                v451 = v449 + 1;
            } else {
                v451 = v449;
            }
            int32_t v453 = v450 + 1; // 0x1227c
            printf((char *)&g20);
            if (v448 < 1) {
                // break -> 0x122a8
                break;
            }
            v448 = v452;
            v449 = v451;
            v450 = v453;
        }
        // 0x122a8
        printf((char *)&g23);
        int32_t v454 = 7;
        int32_t v455 = v451;
        int32_t v456 = v37 + 24;
        int32_t v457;
        while (true) {
            int32_t v458 = v454 - 1; // 0x122d4
            if (((int32_t)v4 >> v454) % 2 != 0) {
                // 0x122f4
                fprintf(g30, "0x%02X", v456);
                fputc(44, g30);
                printf((char *)&g18);
                v457 = v455 + 1;
            } else {
                v457 = v455;
            }
            int32_t v459 = v456 + 1; // 0x1233c
            printf((char *)&g20);
            if (v454 < 1) {
                // break -> 0x12d10
                break;
            }
            v454 = v458;
            v455 = v457;
            v456 = v459;
        }
        // 0x12d10
        v63 = v37 + 32;
        v61 = v457;
        v51 = v49;
    } else {
        v63 = v37;
        v61 = v36;
        v51 = v49;
    }
    goto lab_0x12d10;
  lab_0x11f4c:;
    int32_t v460 = v70 + 1; // 0x11f50
    char * v461 = (char *)(v460 + v30); // 0x11f64
    if (*v461 == 16) {
        goto lab_0x11f70;
    } else {
        // 0x11f4c
        v95 = *v461;
        v85 = v461;
        v41 = v462;
        v70 = v460;
        goto lab_0x11f0c;
    }
  lab_0x12434:
    // 0x12434
    printf((char *)&g10);
    v55 = v104;
    v50 = 10;
    goto lab_0x12490;
  lab_0x123d0:;
    // 0x123d0
    int32_t v489;
    if (v96 == 13) {
        v489 = v42;
        goto lab_0x12410;
    } else {
        // 0x123e8
        *(char *)(v34 + v42) = *v86;
        v489 = v42 + 1;
        goto lab_0x12410;
    }
  lab_0x12490:
    // 0x12490
    *v55 = 0;
    if (strstr((char *)&str3, "41") != NULL) {
        // 0x124b8
        sscanf((char *)&str4, "%02hhX", &v1);
        sscanf((char *)&str7, "%02hhX", &v2);
        sscanf((char *)&str9, "%02hhX", &v3);
        sscanf((char *)&str8, "%02hhX", &v4);
        printf((char *)&g17);
        int32_t v463 = 7;
        int32_t v464 = v36;
        int32_t v465 = v37;
        int32_t v466;
        while (true) {
            int32_t v467 = v463 - 1; // 0x12550
            if (((int32_t)v1 >> v463) % 2 != 0) {
                // 0x12570
                fprintf(g30, "0x%02X", v465);
                fputc(44, g30);
                printf((char *)&g18);
                v466 = v464 + 1;
            } else {
                v466 = v464;
            }
            int32_t v468 = v465 + 1; // 0x125b8
            printf((char *)&g20);
            if (v463 < 1) {
                // break -> 0x125e4
                break;
            }
            v463 = v467;
            v464 = v466;
            v465 = v468;
        }
        // 0x125e4
        printf((char *)&g21);
        int32_t v469 = 7;
        int32_t v470 = v466;
        int32_t v471 = v37 + 8;
        int32_t v472;
        while (true) {
            int32_t v473 = v469 - 1; // 0x12610
            if (((int32_t)v2 >> v469) % 2 != 0) {
                // 0x12630
                fprintf(g30, "0x%02X", v471);
                fputc(44, g30);
                printf((char *)&g18);
                v472 = v470 + 1;
            } else {
                v472 = v470;
            }
            int32_t v474 = v471 + 1; // 0x12678
            printf((char *)&g20);
            if (v469 < 1) {
                // break -> 0x126a4
                break;
            }
            v469 = v473;
            v470 = v472;
            v471 = v474;
        }
        // 0x126a4
        printf((char *)&g22);
        int32_t v475 = 7;
        int32_t v476 = v472;
        int32_t v477 = v37 + 16;
        int32_t v478;
        while (true) {
            int32_t v479 = v475 - 1; // 0x126d0
            if (((int32_t)v3 >> v475) % 2 != 0) {
                // 0x126f8
                fprintf(g30, "0x%02X", v477);
                fputc(44, g30);
                printf((char *)&g18);
                v478 = v476 + 1;
            } else {
                v478 = v476;
            }
            int32_t v480 = v477 + 1; // 0x12740
            printf((char *)&g20);
            if (v475 < 1) {
                // break -> 0x1276c
                break;
            }
            v475 = v479;
            v476 = v478;
            v477 = v480;
        }
        // 0x1276c
        printf((char *)&g23);
        int32_t v481 = 7;
        int32_t v482 = v478;
        int32_t v483 = v37 + 24;
        int32_t v484;
        while (true) {
            int32_t v485 = v481 - 1; // 0x12798
            if (((int32_t)v4 >> v481) % 2 != 0) {
                // 0x127b8
                if (v483 <= 28) {
                    // 0x127c4
                    fprintf(g30, "0x%02X", v483);
                    fputc(44, g30);
                    printf((char *)&g18);
                    v484 = v482 + 1;
                } else {
                    v484 = v482;
                }
            } else {
                v484 = v482;
            }
            int32_t v486 = v483 + 1; // 0x1280c
            printf((char *)&g20);
            if (v481 < 1) {
                // break -> 0x12d10
                break;
            }
            v481 = v485;
            v482 = v484;
            v483 = v486;
        }
        // 0x12d10
        v63 = v37 + 32;
        v61 = v484;
        v51 = v50;
    } else {
        v63 = v37;
        v61 = v36;
        v51 = v50;
    }
    goto lab_0x12d10;
  lab_0x12410:;
    int32_t v487 = v69 + 1; // 0x12414
    char * v488 = (char *)(v487 + v30); // 0x12428
    if (*v488 == 16) {
        goto lab_0x12434;
    } else {
        // 0x12410
        v96 = *v488;
        v86 = v488;
        v42 = v489;
        v69 = v487;
        goto lab_0x123d0;
    }
  lab_0x12904:
    // 0x12904
    printf((char *)&g10);
    v56 = v105;
    v60 = 1;
    goto lab_0x1295c;
  lab_0x128a0:;
    // 0x128a0
    int32_t v490;
    if (v97 == 13) {
        v490 = v43;
        goto lab_0x128e0;
    } else {
        // 0x128b8
        *(char *)(v34 + v43) = *v87;
        v490 = v43 + 1;
        goto lab_0x128e0;
    }
  lab_0x128e0:;
    int32_t v491 = v68 + 1; // 0x128e4
    char * v492 = (char *)(v491 + v30); // 0x128f8
    if (*v492 == 16) {
        goto lab_0x12904;
    } else {
        // 0x128e0
        v97 = *v492;
        v87 = v492;
        v43 = v490;
        v68 = v491;
        goto lab_0x128a0;
    }
}

// Address range: 0x151d4 - 0x1531c
int32_t SerialConnection(int32_t path) {
    int32_t fd = open((char *)path, 258); // 0x151ec
    if (fd != -1) {
        // 0x15208
        fcntl(fd, F_SETFL);
        int32_t termios_p; // bp-72
        tcgetattr(fd, (struct termios *)&termios_p);
        cfsetispeed((struct termios *)&termios_p, 15);
        cfsetospeed((struct termios *)&termios_p, 15);
        termios_p &= -0x3f51;
        tcflush(fd, TCIFLUSH);
        tcsetattr(fd, TCSANOW, (struct termios *)&termios_p);
    } else {
        fd = -1;
    }
    // 0x15310
    return fd;
}

// --------------- Dynamically Linked Functions ---------------

// int cfsetispeed(struct termios * termios_p, speed_t speed);
// int cfsetospeed(struct termios * termios_p, speed_t speed);
// int close(int fd);
// void exit(int status);
// int fclose(FILE * stream);
// int fcntl(int fd, int cmd, ...);
// char * fgets(char * restrict s, int n, FILE * restrict stream);
// FILE * fopen(const char * restrict filename, const char * restrict modes);
// int fprintf(FILE * restrict stream, const char * restrict format, ...);
// int fputc(int c, FILE * stream);
// size_t fwrite(const void * restrict ptr, size_t size, size_t n, FILE * restrict s);
// uint16_t htons(uint16_t hostshort);
// int inet_aton(const char * cp, struct in_addr * inp);
// int ioctl(int fd, unsigned long int request, ...);
// void * memset(void * s, int c, size_t n);
// int open(const char * file, int oflag, ...);
// void perror(const char * s);
// int printf(const char * restrict format, ...);
// int puts(const char * s);
// ssize_t read(int fd, void * buf, size_t nbytes);
// ssize_t sendto(int fd, const void * buf, size_t n, int flags, __CONST_SOCKADDR_ARG addr, socklen_t addr_len);
// int socket(int domain, int type, int protocol);
// int sprintf(char * restrict s, const char * restrict format, ...);
// int sscanf(const char * restrict s, const char * restrict format, ...);
// size_t strlen(const char * s);
// char * strncpy(char * restrict dest, const char * restrict src, size_t n);
// char * strstr(char * haystack, const char * needle);
// intmax_t strtoimax(const char * restrict nptr, char ** restrict endptr, int base);
// char * strtok(char * restrict s, const char * restrict delim);
// int tcflush(int fd, int queue_selector);
// int tcgetattr(int fd, struct termios * termios_p);
// int tcsetattr(int fd, int optional_actions, const struct termios * termios_p);
// ssize_t write(int fd, const void * buf, size_t n);

// --------------------- Meta-Information ---------------------

// Detected compiler/packer: gcc (6.3.0)
// Detected functions: 3
// Decompilation date: 2019-03-26 07:01:08
